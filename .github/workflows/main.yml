name: Transforming with pandoc

on: [push]

jobs:
  convert_via_pandoc:
    runs-on: ubuntu-latest
    steps:
    - uses: actions/checkout@v2
    - name: create output HTML directory
      id: output_HTML_directory
      run: |
        mkdir output_HTML_directory  # create final output dir
        mkdir output_HTML_directory  # create temporary output dir
    - uses: docker://pandoc/latex:3.0
      with:
        args: >- # allows to break string into multiple lines
           --toc  
           -f latex 
           -s --csl 
           --bibliography=BIBLIOGRAPHY/biblio.bib
           --metadata title="OUTPUT_HTML_directory"
           -t chunkedhtml output_HTML_directory
    - uses: actions/upload-artifact@master
      with:
        name: output_HTML_directory
        path: output_HTML_directory
    - name: Publish the web pages
      uses:  peaceiris/actions-gh-pages@v3
      with:
        # ACTIONS_DEPLOY_KEY: ${{ secrets.ACTIONS_DEPLOY_KEY }}
        # PUBLISH_BRANCH: gh-pages
        github_token: ${{ secrets.GITHUB_TOKEN }}
        publish_dir: ./out

